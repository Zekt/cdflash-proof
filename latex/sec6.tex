\section{Proof of Crash-Determinacy}
\label{sec:proof}
\begin{proof}[Proof of case \i{\actwc} in\ \cref{theoremPI}]
	We can safely assume that there exists $\i{t_0} \in \i{SpecState}$ such that $\i{AR(s_0, t_0)}$, then by repeatedly applying \cref{lemma-1} to the first relation, we have $\i{AR(s, t)}$ and $\i{AR(s', t')}$, as sketched in \cref{fig:casewPI1}.
	\begin{figure} [b] \centering
			\begin{tikzpicture}
			\matrix (m) [matrix of math nodes, row sep=3em, column sep=5em, minimum width=2em]
			{ s & \vphantom{s}\smash{s'} & \vphantom{s}\smash{s''} \\
			  t & \vphantom{t}\smash{\exists t'} & \vphantom{t}\smash{\exists t''} \\};
			\path[-stealth]
			(m-1-1) edge [dashed, -] node [left] {$\i{AR}$} (m-2-1)
					edge [->>] node [above] {\scriptsize{$ \i{(\actw \lor \actf)*} \cdot \actf $}}
							   node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-2)
			(m-2-1) edge [->>] node [above] {\scriptsize{$\i{(\actw \lor \actf)*} \cdot \actf$}}
							   node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-2)
			(m-1-2) edge [dashed, -] node [left] {$\i{AR}$} (m-2-2)
					edge [->>] node [above] {\scriptsize{$\i{\actw*} \cdot \actwc \cdot \i{\actrc*} \cdot \actr$}}
							   node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-3)
			(m-2-2) edge [->>] node [above] {\scriptsize{$\i{\actw*} \cdot \actwc \cdot \i{\actrc*} \cdot \actr$}}
							   node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-3)
			(m-1-3) edge [dashed, -] node [left] {?} (m-2-3);

		\end{tikzpicture}

		\caption{Incomplete proof sketch of case \i{\actwc} of \cref{theoremPI}}
		\label{fig:casewPI1}
	\end{figure}\\
	We can find some intermediate states $s'_1$, $s'_2$, $s'_3$ by \cref{def:frag}, and by applying \cref{lemma-1} repeatedly to obtain \cref{casewPI2}.
	\begin{figure*}[h] \centering
			    \begin{tikzpicture}
			\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em, minimum width=2em]
			{ s & \vphantom{s}\smash{s'} & \vphantom{s}\smash{s'_1} & \vphantom{s}\smash{s'_2} & \vphantom{s}\smash{s'_3} & \vphantom{s}\smash{s''} \\
			  t & \vphantom{t}\smash{\exists t'} & \vphantom{t}\smash{\exists t'_1} & \vphantom{t}\smash{\exists t'_2} & \vphantom{t}\smash{\exists t'_3} & \vphantom{t}\smash{\exists t''} \\ };
			\path[-stealth]
			(m-1-1) edge [dashed, -] node [left] {$\i{AR}$} (m-2-1)
					edge [->>] node [above] {\scriptsize{$\i{((\actw \lor \actf)*)} \actf $}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-2)
			(m-2-1) edge [->>] node [above] {\scriptsize{$\i{((\actw \lor \actf)*)} \actf $}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-2)
			(m-1-2) edge [dashed, -] node [left] {$\i{AR}$} (m-2-2)
					edge [->>] node [above] {\scriptsize{$\i{\actw*}$}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-3)
			(m-2-2) edge [->>] node [above] {\scriptsize{$\i{\actw*}$}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-3)
			(m-1-3) edge [dashed, -] node [left] {$\i{AR}$} (m-2-3)
					edge [->] node [above] {\scriptsize{$\i{\actwc}$}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-4)
			(m-2-3) edge [->] node [above] {\scriptsize{$\i{\actwc}$}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-4)
			(m-1-4) edge [dashed, -] node [left] {$\i{CR}$} (m-2-4)
					edge [->>] node [above] {\scriptsize{$\i{r^c*}$}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-5)
			(m-2-4) edge [->>] node [above] {\scriptsize{$\i{r^c*}$}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-5)
			(m-1-5) edge [dashed, -] node [left] {$\i{CR}$} (m-2-5)
					edge [->] node [above] {\scriptsize{$ \i{\actr}$}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-6)
			(m-2-5) edge [->] node [above] {\scriptsize{$ \i{\actr}$}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-6)
			(m-1-6) edge [dashed, -] node [left] {$\i{AR}$} (m-2-6);

		\end{tikzpicture}

		\caption{Complete proof sketch of case \i{\actwc} of \cref{theoremPI}}
		\label{casewPI2}
	\end{figure*}
	The proof then can be completed by mapping the states in \i{ProgState^\dagger} to states in \i{SpecState} by observational equivalence (\cref{ObsEquiv}), thus crash-determinancy on \Spec\ (\cref{cdS}) entails crash-determinancy on \ProgInv:
\begin{align*}
	\i{read(s')}   &\equiv \i{volatile(t')}   \tag{by \cref{ObsEquiv}} \\
	& \qquad \quad \rotatebox{90}{$\equiv$} \tag{by \cref{cdS}}\\
	\i{read(s'')} &\equiv \i{volatile(t'')} \tag{by \cref{ObsEquiv}}
\end{align*}
\end{proof} 
\begin{proof}[Proof of case $\actfc$ in \cref{theoremPI}]
	Similarly to proof of case $\actwc$, we can find $t_0 \in \i{SpecState}$ such that $\i{AR(s_0, t_0)}$, and some states $s''_1, s''_2$ by \cref{def:frag} to obtain \cref{casefPI2}.
	By \cref{cdS}, either $\i{volatile(s')} \equiv \i{volatile(s''')}$ or $\i{volatile(s'')} \equiv \i{volatile(s''')}$. If $\i{volatile(s')} \equiv \i{volatile(s''')}$,
	\begin{align*}
	\i{read(s')}   &\equiv \i{volatile(t')} \tag{by \cref{ObsEquiv}} \\
	& \qquad \quad \rotatebox{90}{$\equiv$} \tag{by \cref{cdS}}\\
	\i{read(s''')} &\equiv \i{volatile(t''')} \tag{by \cref{ObsEquiv}}
	\end{align*}
	Similarly, if $\i{volatile(s'')} \equiv \i{volatile(s''')}$,
	\begin{align*}
	\i{read(s'')}   &\equiv \i{volatile(t'')} \tag{by \cref{ObsEquiv}} \\
	& \qquad \quad \rotatebox{90}{$\equiv$} \tag{by \cref{cdS}}\\
	\i{read(s''')} &\equiv \i{volatile(t''')} \tag{by \cref{ObsEquiv}}
	\end{align*}
	\begin{figure*}[h] \centering
		\begin{tikzpicture}
		\matrix (m) [matrix of math nodes, row sep=3em, column sep=4em, minimum width=2em]
		{ s & \vphantom{s}\smash{s'} & \vphantom{s}\smash{s''} & \vphantom{s}\smash{s''_1} & \vphantom{s}\smash{s''_2} & \vphantom{s}\smash{s'''} \\
			t & \vphantom{t}\smash{\exists t'} & \vphantom{t}\smash{\exists t''} & \vphantom{t}\smash{\exists t''_1} & \vphantom{t}\smash{\exists t''_2} & \vphantom{t}\smash{\exists t'''} \\ };
		\path[-stealth]
		(m-1-1) edge [dashed, -] node [left] {$\i{AR}$} (m-2-1)
		edge [->>] node [above] {\scriptsize{$\i{((\actw \lor \actf)*)} \actf $}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-2)
		(m-2-1) edge [->>] node [above] {\scriptsize{$\i{((\actw \lor \actf)*)} \actf $}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-2)
		(m-1-2) edge [dashed, -] node [left] {$\i{AR}$} (m-2-2)
		edge [->>] node [above] {\scriptsize{$\i{\actw*}$}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-3)
		(m-2-2) edge [->>] node [above] {\scriptsize{$\i{\actw*}$}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-3)
		(m-1-3) edge [dashed, -] node [left] {$\i{AR}$} (m-2-3)
		edge [->] node [above] {\scriptsize{$\i{\actwc}$}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-4)
		(m-2-3) edge [->] node [above] {\scriptsize{$\i{\actwc}$}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-4)
		(m-1-4) edge [dashed, -] node [left] {$\i{CR}$} (m-2-4)
		edge [->>] node [above] {\scriptsize{$\i{r^c*}$}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-5)
		(m-2-4) edge [->>] node [above] {\scriptsize{$\i{r^c*}$}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-5)
		(m-1-5) edge [dashed, -] node [left] {$\i{CR}$} (m-2-5)
		edge [->] node [above] {\scriptsize{$ \i{\actr}$}} node [at end, below=-0.1em] {\scriptsize{\ProgInv}} (m-1-6)
		(m-2-5) edge [->] node [above] {\scriptsize{$ \i{\actr}$}} node [at end, below=-0.1em] {\scriptsize{\Spec}} (m-2-6)
		(m-1-6) edge [dashed, -] node [left] {$\i{AR}$} (m-2-6);
		
		\end{tikzpicture}
		
		\caption{Complete proof sketch of case \i{\actfc} of \cref{theoremPI}}
		\label{casefPI2}
	\end{figure*}
\end{proof}
\begin{proof}[Proof of \cref{theoremP}]
\end{proof}